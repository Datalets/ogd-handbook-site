<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>Embedding - handbook.opendata.swiss</title>

	<script src="../js/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
	<script src="https://cdn.rawgit.com/okfn/ckan.js/master/ckan.js"></script>
	<script src="../js/ckan-embed.min.js"></script>
</head>
<body style="padding:0;margin:0;color:#555;font:14px/19px 'Helvetica Neue',Helvetica,Arial,sans-serif">
  <p>To get started with <a href="/en/library/embed.html" target="_blank">embedding</a> a dataset from
		<a href="https://opendata.swiss" target="_blank"><b>opendata.swiss</b></a>,
		type a search term or query expression here:
	</p>
	<form id="form-widget">
		<input type="text" id="input-search"><button type="submit">Search ...</button>
	</form>
	<input type="text" id="embed-code" style="display:none">
	<p id="embed-tip" style="display:none">
		Press Ctrl-C to copy the embedding code to your clipboard.
		Insert into a webpage where you wish for the widget to appear.
	</p>
	<div id="example-1" style="border:1px solid #ccc; padding:10px;">
		Results of your search query should appear here.
	</div>
	<script>

		$('#form-widget').submit(function(e) {
			e.preventDefault(); e.stopPropagation();
			var q = $('#input-search').val();
			console.log('Querying: ' + q);
			//ck.datasets('#example-1', 'https://opendata.swiss/', q);
			var embedcode = ''.concat(
				'<script src="https://cdn.rawgit.com/opendata-swiss/ckan-embed/1.0.0/dist/ckan-embed.min.js"></','script>',
				'<div id="ckan-embed-1"></div>',
				'<script>ck.datasets("#ckan-embed-1","https://opendata.swiss/","', q, '");</','script>'
			);
			var tgt = $('#embed-code');
			tgt.show(); $('#embed-tip').show();
			tgt.val(embedcode).focus();
			tgt[0].setSelectionRange(0, embedcode.length);
		});
	</script>
	<hr>
	<a href="#" target="_blank">Open in new tab</a>.

</body>
</html>
